<!DOCTYPE html>
<html data-require="math math-format interactive graphie">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Equivalent Fractions 3</title>
        <script src="../khan-exercise.js"></script>
        <script>
            function arrayInArray(needle, haystack) {
                var target=JSON.stringify(needle);
                $.each(haystack, function(i,element) {
                    if (JSON.stringify(haystack[i]) == target) {
                        return i;
                    }
                })
                return -1;
            }
        </script>
        <style>
        .answer {
            float:left; padding:10px 40px 10px 0px;
        }
        </style>
    </head>
    <body>
        <div class="exercise">
            <div class="vars">
                <var id="FRACTIONS">randRange(1, 30, 4, 2)</var>
                <var id="ANSWER1">randFromArray(FRACTIONS)</var>
                <var id="MULTIPLIER">randRange(2, 4)</var>
                <var id="ANSWER2">[[ANSWER1[0] * MULTIPLIER, ANSWER1[1] * MULTIPLIER]]</var>
                <var id="OPTIONSINC">shuffle(FRACTIONS.concat(ANSWER2))</var>
                <var id="OPTIONS">shuffle(FRACTIONS)</var>
            </div>
            <div class="problems">
                <div id="pair">
                    <p class="question">Find the pair of equivalent fractions below:</p>
                    <div class="problem">
                        <ul id="list" class="ui-helper-clearfix">
                            <li class="answer">
                                <input type="checkbox" id="check0">
                                <label for="check0">
                                    <code><var>fraction(OPTIONSINC[0][0],OPTIONSINC[0][1])</var></code>
                                </label>
                            </li>
                            <li class="answer">
                                <input type="checkbox" id="check1">
                                <label for="check1">
                                    <code><var>fraction(OPTIONSINC[1][0],OPTIONSINC[1][1])</var></code>
                                </label>
                            </li>
                            <li class="answer">
                                <input type="checkbox" id="check2">
                                <label for="check2">
                                    <code><var>fraction(OPTIONSINC[2][0],OPTIONSINC[2][1])</var></code>
                                </label>
                            </li>
                            <li class="answer">
                                <input type="checkbox" id="check3">
                                <label for="check3">
                                    <code><var>fraction(OPTIONSINC[3][0],OPTIONSINC[3][1])</var></code>
                                </label>
                            </li>
                            <li class="answer">
                                <input type="checkbox" id="check4">
                                <label for="check4">
                                    <code><var>fraction(OPTIONSINC[4][0],OPTIONSINC[4][1])</var></code>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="solution" data-type="custom">
                        <div class="instruction">Select two equivalent fractions.</div>
                        <div class="guess">
                            _.map($("input[type=checkbox]:checked"),function(object){
                                return OPTIONSINC[parseInt(object.id.match(/\d+$/))];
                            })
                        </div>
                        <div class="validator-function">
                            if (guess.length &lt; 2 || guess.length &gt; 2 ) {
                                return "";
                            }
                            return abs(guess[0][0] / guess[0][1] - guess[1][0] / guess[1][1]) &lt; pow(2, -42);
                        </div>
                        <div class="show-guess">
                            $('#check' + arrayInArray([guess[0][0], guess[0][1]], OPTIONSINC)).prop('checked',true);
                            $('#check' + arrayInArray([guess[1][0], guess[1][1]], OPTIONSINC)).prop('checked',true);
                        </div>
                    </div>
                    <div class="hints">
                        <p>
                            One way to solve this is to reduce each fraction to its simplest form.
                            For example, the first fraction can be reduced to
                            <code><var>fraction(OPTIONSINC[0][0],OPTIONSINC[0][1],true,true)</var></code>.
                        </p>
                        <div>
                            Here are all the fractions reduced. Which two are the same?
                            <ul id="list" class="ui-helper-clearfix">
                                <li data-each="OPTIONSINC as OPTION" class="answer" style="padding-right:70px">
                                     <code><var>fraction(OPTION[0],OPTION[1],true,true)</var></code>
                                </li>
                            </ul>
                        </div>
                        <p>
                            <code><var>fraction(ANSWER1[0],ANSWER1[1])</var> =
                            <var>fraction(ANSWER2[0][0],ANSWER2[0][1])</var></code>
                        </p>
                    </div>
                </div>

                <div id="match">
                    <p class="question">
                        Find a different form of the fraction
                        <code><var>fraction(ANSWER2[0][0],ANSWER2[0][1])</var></code>
                    </p>
                    <div class="problem">
                        <ul class="ui-helper-clearfix">
                            <li class="answer">
                                <input type="checkbox" id="check0">
                                <label for="check0">
                                    <code><var>fraction(OPTIONS[0][0],OPTIONS[0][1])</var></code>
                                </label>
                            </li>
                            <li class="answer">
                                <input type="checkbox" id="check1">
                                <label for="check1">
                                    <code><var>fraction(OPTIONS[1][0],OPTIONS[1][1])</var></code>
                                </label>
                            </li>
                            <li class="answer">
                                <input type="checkbox" id="check2">
                                <label for="check2">
                                    <code><var>fraction(OPTIONS[2][0],OPTIONS[2][1])</var></code>
                                </label>
                            </li>
                            <li class="answer">
                                <input type="checkbox" id="check3">
                                <label for="check3">
                                    <code><var>fraction(OPTIONS[3][0],OPTIONS[3][1])</var></code>
                                </label>
                            </li>
                        </ul>
                    </div>
                    <div class="solution" data-type="custom">
                        <div class="instruction">
                            Select the equivalent fraction.
                        </div>
                        <div class="guess">
                            _.map($("input[type=checkbox]:checked"),function(object){
                                return OPTIONS[parseInt(object.id.match(/\d+$/))]
                            })
                        </div>
                        <div class="validator-function">
                            if (guess.length !== 1 ) {
                                return "";
                            }
                            return abs(guess[0][0] / guess[0][1] - ANSWER1[0] / ANSWER1[1]) &lt; pow(2, -42);
                        </div>
                        <div class="show-guess">
                            $('#check' + arrayInArray([guess[0][0], guess[0][1]], OPTIONSINC)).prop('checked', true);
                        </div>
                    </div>
                    <div class="hints">
                        <p>
                            Reduce the fraction we are looking for down to its simplest form:
                            <code><var>fraction(ANSWER1[0], ANSWER1[1], true, true)</var></code>.
                        </p>
                        <div>
                            <p>Reduce each fraction down to its simplest form.</p>
                            <ul>
                                <li data-each="OPTIONS as OPTION" class="answer" style="padding-right:70px">
                                    <code><var>fraction(OPTION[0], OPTION[1], true, true)</var></code>
                                </li>
                            </ul>
                        </div>
                        <p style="clear:both; padding-top:20px">Identify the fraction which match.</p>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
